<html xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      xmlns:th="http://www.thymeleaf.org"
      layout:decorate="~{fragments/layout}">
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body>
<div layout:fragment="content" th:remove="tag">
    <div class="col-md-12">
        <h1 class="text-center">Report of All User</h1><br/>
        <button th:if="${reportList.size() > 0}" style="border-radius: 0; margin-bottom: 2px" id="exportButton" class="btn btn-lg btn-danger clearfix"><span class="fa fa-file-excel-o"></span> Export to Excel</button>
        <form th:action="@{/user/searchByName/stake}" th:object="${tempUser}" method="post" class="from-group">

            <!--<input class="from-control" type="datetime-local" data-date-format="DD MMMM YYYY" th:field="*{startDate}">-->
            <div class="form-group col-md-3">
                <label for="stakeHolder_id">Search option</label>:
                <select th:field="*{searchOption}"  class="form-control" id="stakeHolder_id">
                    <option th:value="None">None</option>
                    <option th:value="cutomerNumber">Search by Customer Number</option>
                    <option th:value="billNumber">Search by Bill Number</option>
                    <!--<option th:value="stakename">Search by Stakeholder Name</option>-->
                    <option th:value="status">Search by Status</option>
                    <option th:value="amount">Search by Amount Range</option>
                    <option th:value="daterange">Search by Date and Time Range</option>
                </select>
            </div>
            <div class="form-group col-md-4" style="margin-top: 5px">
                <label for="id"></label>:
                <input type="text" th:field="*{id}" id="id" class="form-control" autofocus="autofocus" placeholder="Enter your details">
                <label th:if="${#fields.hasErrors('id')}" th:errors="*{id}" th:class="'error'">Enter Name</label>
            </div>
            <div class="form-group col-md-4" style="margin-top: 4px">
                <label for="name"></label>:
                <input type="text" th:field="*{endAmount}" id="name" class="form-control" autofocus="autofocus" placeholder="This field is only for amount range">
                <label th:if="${#fields.hasErrors('endAmount')}" th:errors="*{id}" th:class="'error'">Enter Name</label>
            </div>
            <button type="submit" class="btn btn-primary btn-success" style="margin-top: 23px">Submit</button>
            <input type="datetime-local" class="form-control" th:field="*{startDate}">
            <input type="datetime-local" class="form-control" th:field="*{endDate}">
        </form>
        <table id="exportTable" class="table table-hover">
            <thead>
            <tr>
                <th style="text-align: center">Id</th>
                <th style="text-align: center">Bank_Tranxn_Id</th>
                <th style="text-align: center">Bill_Amount</th>
                <th style="text-align: center">Bill_Number</th>
                <th style="text-align: center">Bill_Status</th>
                <th style="text-align: center">Bill_Type</th>
                <th style="text-align: center">Cancel_Date</th>
                <th style="text-align: center">Cancel_By</th>
                <th style="text-align: center">Customer_Number</th>
                <th style="text-align: center">Due_Amount</th>
                <th style="text-align: center">Due_Date</th>
                <th style="text-align: center">Issue_Date</th>
                <th style="text-align: center">Paid_By</th>
                <th style="text-align: center">Pay_Date</th>
                <th style="text-align: center">Remarks</th>
                <th style="text-align: center">Total_Amount</th>
                <th style="text-align: center">Utility_Tranxn_Id</th>
                <th style="text-align: center">Vat_Amount</th>
                <th style="text-align: center">Paid_Amount</th>
            </tr>
            </thead>

            <tbody>
            <tr th:each="report : ${reportList}">
                <td th:text="${report.getId()}"></td>
                <td th:text="${report.getBank_tranxn_id()}"></td>
                <td th:text="${report.getBill_amount()}"></td>
                <td th:text="${report.getBill_number()}"></td>
                <td th:text="${report.getBill_status_info().id}"></td>
                <td th:text="${report.getBill_type()}"></td>
                <td th:text="${report.getCancel_date()}"></td>
                <td th:text="${report.getCanceled_by()}"></td>
                <td th:text="${report.getUsers().id}"></td>
                <td th:text="${report.getDue_amount()}"></td>
                <td th:text="${report.getIssue_date()}"></td>
                <td th:text="${report.getDue_date()}"></td>
                <td th:text="${report.getPaid_by()}"></td>
                <td th:text="${report.getPay_date()}"></td>
                <td th:text="${report.getRemarks()}"></td>
                <td th:text="${report.getTotal_amount()}"></td>
                <td th:text="${report.getUtility_tranxn_id() }"></td>
                <td th:text="${report.getVat_amount()}"></td>
                <td th:text="${report.getPaid_amount()}"></td>
                <!--<td> <a th:href="${'/stake/edit/'+ stakeholder.getId()}" class="btn"> <i class="fa fa-pencil-square-o"></i> </a>  <a th:href="${'/stake/delete/' + stakeholder.getId()}" class="btn"> <i class="fa fa-trash-o"></i> </a></td>-->
            </tr>
            </tbody>


        </table>
    </div>
    <script type="text/javascript">
        jQuery(function ($) {
            $("#exportButton").click(function () {
                // parse the HTML table element having an id=exportTable
                var dataSource = shield.DataSource.create({
                    data: "#exportTable",
                    schema: {
                        type: "table",
                        fields: {
                            Id: { type: Number },
                            Bank_Tranxn_Id: { type: String },
                            Bill_Amount: { type: Number },
                            Bill_Number: { type: String },
                            Bill_Status: { type: Number},
                            Bill_Type:   { type: Number },
                            Cancel_Date: { type: String},
                            Cancel_By:   { type: String},
                            Customer_Number: { type: Number},
                            Due_Amount: { type: Number},
                            Due_Date: { type: String},
                            Issue_Date: { type: String},
                            Paid_By: { type: String},
                            Pay_Date: { type: String},
                            Remarks: { type: String},
                            Total_Amount: { type: Number},
                            Utility_Tranxn_Id: { type: Number},
                            Vat_Amount : { type: Number},
                            Paid_Amount : { type: Number}

                        }
                    }
                });

                // when parsing is done, export the data to Excel
                dataSource.read().then(function (data) {
                    new shield.exp.OOXMLWorkbook({
                        author: "PrepBootstrap",
                        worksheets: [
                            {
                                name: "PrepBootstrap Table",
                                rows: [
                                    {
                                        cells: [
                                            {
                                                style: {
                                                    bold: true
                                                },
                                                type: String,
                                                value: "Id"
                                            },
                                            {
                                                style: {
                                                    bold: true
                                                },
                                                type: String,
                                                value: "Bank Tranxn Id"
                                            },
                                            {
                                                style: {
                                                    bold: true
                                                },
                                                type: String,
                                                value: "Bill Amount"
                                            },
                                            {
                                                style: {
                                                    bold: true
                                                },
                                                type: String,
                                                value: "Bill Number"
                                            },
                                            {
                                                style: {
                                                    bold: true
                                                },
                                                type: String,
                                                value: "Bill Status"
                                            },
                                            {
                                                style: {
                                                    bold: true
                                                },
                                                type: String,
                                                value: "Bill Type"
                                            },
                                            {
                                                style: {
                                                    bold: true
                                                },
                                                type: String,
                                                value: "Cancel Date"
                                            },
                                            {
                                                style: {
                                                    bold: true
                                                },
                                                type: String,
                                                value: "Cancel By"
                                            },
                                            {
                                                style: {
                                                    bold: true
                                                },
                                                type: String,
                                                value: "Customer Number"
                                            },
                                            {
                                                style: {
                                                    bold: true
                                                },
                                                type: String,
                                                value: "Due Amount"
                                            },
                                            {
                                                style: {
                                                    bold: true
                                                },
                                                type: String,
                                                value: "Due Date"
                                            },
                                            {
                                                style: {
                                                    bold: true
                                                },
                                                type: String,
                                                value: "Issue Date"
                                            },
                                            {
                                                style: {
                                                    bold: true
                                                },
                                                type: String,
                                                value: "Paid By"
                                            },
                                            {
                                                style: {
                                                    bold: true
                                                },
                                                type: String,
                                                value: "Pay Date"
                                            },
                                            {
                                                style: {
                                                    bold: true
                                                },
                                                type: String,
                                                value: "Remarks"
                                            },
                                            {
                                                style: {
                                                    bold: true
                                                },
                                                type: String,
                                                value: "Total Amount"
                                            },
                                            {
                                                style: {
                                                    bold: true
                                                },
                                                type: String,
                                                value: "Utility Tranxn Id"
                                            },
                                            {
                                                style: {
                                                    bold: true
                                                },
                                                type: String,
                                                value: "Vat Amount"
                                            },
                                            {
                                                style: {
                                                    bold: true
                                                },
                                                type: String,
                                                value: "Paid Amount"
                                            },
                                        ]
                                    }
                                ].concat($.map(data, function(item) {
                                    return {
                                        cells: [
                                            { type: Number, value: item.Id },
                                            { type: String, value: item.Bank_Tranxn_Id},
                                            { type: Number, value: item.Bill_Amount },
                                            { type: String, value: item.Bill_Number },
                                            { type: Number, value: item.Bill_Status },
                                            { type: Number, value: item.Bill_Type },
                                            { type: String, value: item.Cancel_Date },
                                            { type: String, value: item.Cancel_By },
                                            { type: Number, value: item.Customer_Number },
                                            { type: Number, value: item.Due_Amount },
                                            { type: String, value: item.Due_Date },
                                            { type: String, value: item.Issue_Date },
                                            { type: String, value: item.Paid_By },
                                            { type: String, value: item.Pay_Date },
                                            { type: String, value: item.Remarks },
                                            { type: Number, value: item.Total_Amount },
                                            { type: Number, value: item.Utility_Tranxn_Id },
                                            { type: Number, value: item.Vat_Amount },
                                            { type: Number, value: item.Paid_Amount},
                                        ]
                                    };
                                }))
                            }
                        ]
                    }).saveAs({
                        fileName: "PrepBootstrapExcel"
                    });
                });
            });
        });
    </script>



</div>
</body>
</html>